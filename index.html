<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nin Online Tournaments - Hawk Server</title>
    <!-- ADICIONADO ID para o script encontrar e alterar o favicon -->
    <link rel="icon" type="image/png" href="./icon.png" id="dynamic-favicon">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React Core -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel para traduzir JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: #0f172a; }
        ::-webkit-scrollbar-thumb { background: #334155; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #475569; }
        .scrollbar-hide::-webkit-scrollbar { display: none; }
        .scrollbar-hide { -ms-overflow-style: none; scrollbar-width: none; }
    </style>
</head>
<body class="bg-slate-950 text-slate-100 font-sans">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo, useRef, useLayoutEffect } = React;

        // --- ÍCONES SVG INTEGRADOS ---
        const IconBase = ({ children, className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>{children}</svg>
        );
        const Trophy = (props) => <IconBase {...props}><path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"/><path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"/><path d="M4 22h16"/><path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22"/><path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22"/><path d="M18 2H6v7a6 6 0 0 0 12 0V2Z"/></IconBase>;
        const Swords = (props) => <IconBase {...props}><polyline points="14.5 17.5 3 6 3 3 6 3 17.5 14.5"/><line x1="13" x2="19" y1="19" y2="13"/><line x1="16" x2="20" y1="16" y2="20"/><line x1="19" x2="21" y1="21" y2="19"/></IconBase>;
        const Users = (props) => <IconBase {...props}><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></IconBase>;
        const Medal = (props) => <IconBase {...props}><circle cx="12" cy="17" r="5"/><path d="M9 17v-8"/><path d="M15 17v-8"/><path d="M9 17h6"/><path d="M12 2v5"/><path d="M12 2l-4 5"/><path d="M12 2l4 5"/></IconBase>;
        const TrendingUp = (props) => <IconBase {...props}><polyline points="22 7 13.5 15.5 8.5 10.5 2 17"/><polyline points="16 7 22 7 22 13"/></IconBase>;
        const Search = (props) => <IconBase {...props}><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></IconBase>;
        const Calendar = (props) => <IconBase {...props}><rect width="18" height="18" x="3" y="4" rx="2" ry="2"/><line x1="16" x2="16" y1="2" y2="6"/><line x1="8" x2="8" y1="2" y2="6"/><line x1="3" x2="21" y1="10" y2="10"/></IconBase>;
        const Clock = (props) => <IconBase {...props}><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></IconBase>;
        const XIcon = (props) => <IconBase {...props}><path d="M18 6 6 18"/><path d="m6 6 12 12"/></IconBase>;
        const Filter = (props) => <IconBase {...props}><polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"/></IconBase>;
        const ChevronDown = (props) => <IconBase {...props}><path d="m6 9 6 6 6-6"/></IconBase>;
        const ArrowRight = (props) => <IconBase {...props}><path d="M5 12h14"/><path d="m12 5 7 7-7 7"/></IconBase>;
        const Loader2 = (props) => <IconBase {...props}><path d="M21 12a9 9 0 1 1-6.219-8.56"/></IconBase>;
        const AlertCircle = (props) => <IconBase {...props}><circle cx="12" cy="12" r="10"/><line x1="12" x2="12" y1="8" y2="12"/><line x1="12" x2="12.01" y1="16" y2="16"/></IconBase>;
        const ServerIcon = (props) => <IconBase {...props}><rect x="2" y="2" width="20" height="8" rx="2" ry="2"/><rect x="2" y="14" width="20" height="8" rx="2" ry="2"/><line x1="6" x2="6.01" y1="6" y2="6"/><line x1="6" x2="6.01" y1="18" y2="18"/></IconBase>;
        const InfoIcon = (props) => <IconBase {...props}><circle cx="12" cy="12" r="10"/><line x1="12" x2="12" y1="16" y2="12"/><line x1="12" x2="12.01" y1="8" y2="8"/></IconBase>;
        const Menu = (props) => <IconBase {...props}><line x1="4" x2="20" y1="12" y2="12"/><line x1="4" x2="20" y1="6" y2="6"/><line x1="4" x2="20" y1="18" y2="18"/></IconBase>;
        const TrendingDown = (props) => <IconBase {...props}><polyline points="22 17 13.5 8.5 8.5 13.5 2 7"/><polyline points="16 17 22 17 22 11"/></IconBase>;
        const ShieldCheck = (props) => <IconBase {...props}><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/><path d="m9 12 2 2 4-4"/></IconBase>;
        const GitBranch = (props) => <IconBase {...props}><line x1="6" x2="6" y1="3" y2="15"/><circle cx="18" cy="6" r="3"/><circle cx="6" cy="18" r="3"/><path d="M18 9a9 9 0 0 1-9 9"/></IconBase>;

        // --- CONFIGURAÇÃO ---
        const DATA_FILES = ['./servidor_page_1.json']; 
        const CUSTOM_ICON_URL = './icon.png'; 
        const PRIORITY_MODES = ['Auto1v1', 'Auto2v2', 'Auto3v3', 'DBE1v1', 'DBE2v2'];
        
        // Descrições para cada categoria (ATUALIZADA)
        const MODE_DESCRIPTIONS = {
            'Geral': 'Visão completa de todas as partidas registradas no servidor, incluindo eventos e ranqueadas.',
            'Ranked': 'Soma exclusiva das filas ranqueadas automáticas (Auto1v1, Auto2v2 e Auto3v3).',
            'Auto1v1': 'Partidas ranqueadas automatizadas no formato 1 contra 1.',
            'Auto2v2': 'Partidas ranqueadas automatizadas no formato 2 contra 2.',
            'Auto3v3': 'Partidas ranqueadas automatizadas no formato 3 contra 3.',
            'DBE1v1': 'Dodge Ball Event (Queimada) no formato 1v1.',
            'DBE2v2': 'Dodge Ball Event (Queimada) no formato 2v2.',
            'Default': 'Estatísticas detalhadas para este modo de jogo específico.'
        };

        // --- LÓGICA DO APLICATIVO ---

        const processBattleLogs = (data) => {
            const stats = {};
            const history = {};

            const initPlayer = (name) => {
                if (!stats[name]) {
                    stats[name] = { name, wins: 0, losses: 0, battles: 0, winRate: 0, modes: {} };
                    history[name] = [];
                }
            };

            const updateModeStats = (playerName, mode, result) => {
                if (!stats[playerName].modes[mode]) {
                    stats[playerName].modes[mode] = { wins: 0, losses: 0, battles: 0 };
                }
                stats[playerName].modes[mode].battles += 1;
                if (result === 'win') stats[playerName].modes[mode].wins += 1;
                else stats[playerName].modes[mode].losses += 1;
            };

            if (!Array.isArray(data)) return { rankings: [], history: {} };

            data.forEach(log => {
                const content = log.content || "";
                const match = content.match(/^\[(.*?)\] (.*?) derrotou (.*)/);

                if (match) {
                    const mode = match[1]; 
                    const winnersPart = match[2];
                    const losersPart = match[3];
                    const timestamp = log.timestamp;

                    const winners = winnersPart.split(',').map(n => n.trim()).filter(n => n.length > 0);
                    const losers = losersPart.split(',').map(n => n.trim()).filter(n => n.length > 0);

                    winners.forEach(winner => {
                        initPlayer(winner);
                        stats[winner].wins += 1;
                        stats[winner].battles += 1;
                        updateModeStats(winner, mode, 'win');
                        history[winner].push({ opponent: losers.join(', '), result: 'win', timestamp: timestamp, mode: mode });
                    });

                    losers.forEach(loser => {
                        initPlayer(loser);
                        stats[loser].losses += 1;
                        stats[loser].battles += 1;
                        updateModeStats(loser, mode, 'loss');
                        history[loser].push({ opponent: winners.join(', '), result: 'loss', timestamp: timestamp, mode: mode });
                    });
                }
            });

            const rankings = Object.values(stats).map(player => ({
                ...player,
                winRate: player.battles > 0 ? ((player.wins / player.battles) * 100).toFixed(1) : 0
            })).sort((a, b) => b.wins - a.wins);

            return { rankings, history };
        };

        const Card = ({ title, value, icon: Icon, colorClass }) => (
            <div className="bg-slate-800 p-6 rounded-lg shadow-lg border border-slate-700 flex items-center space-x-4 animate-in fade-in duration-500">
                <div className={`p-3 rounded-full ${colorClass} bg-opacity-20`}>
                    <Icon className={`w-6 h-6 ${colorClass.replace('bg-', 'text-')}`} />
                </div>
                <div>
                    <p className="text-slate-400 text-sm font-medium">{title}</p>
                    <h3 className="text-2xl font-bold text-white">{value}</h3>
                </div>
            </div>
        );

        // --- COMPONENTE DE GRÁFICO SIMPLES ---
        const PlayerPerformanceChart = ({ matches }) => {
            const [hoveredStat, setHoveredStat] = useState(null);
            const [tooltipPos, setTooltipPos] = useState({ x: 0, y: 0 });
            const scrollRef = useRef(null);

            const statsByDate = useMemo(() => {
                const groups = {};
                const sortedMatches = [...matches].sort((a, b) => new Date(a.timestamp) - new Date(b.timestamp));
                
                sortedMatches.forEach(match => {
                    const date = new Date(match.timestamp).toLocaleDateString('pt-BR', { day: '2-digit', month: '2-digit' });
                    if (!groups[date]) groups[date] = { date, wins: 0, losses: 0, total: 0 };
                    groups[date].total += 1;
                    if (match.result === 'win') groups[date].wins += 1;
                    else groups[date].losses += 1;
                });
                
                return Object.values(groups); 
            }, [matches]);

            useLayoutEffect(() => {
                if (scrollRef.current) {
                    setTimeout(() => {
                        if (scrollRef.current) {
                            scrollRef.current.scrollLeft = scrollRef.current.scrollWidth;
                        }
                    }, 50); 
                }
            }, [statsByDate]);

            const handleMouseMove = (e) => {
                setTooltipPos({ x: e.clientX, y: e.clientY });
            };

            if (statsByDate.length === 0) return null;

            const maxVal = Math.max(...statsByDate.map(d => Math.max(d.wins, d.losses))); 

            return (
                <div className="bg-slate-950/50 rounded-xl p-4 border border-slate-800 mb-4 flex flex-col relative" >
                    {hoveredStat && (
                        <div 
                            className="fixed z-50 pointer-events-none bg-slate-800 border border-slate-600 text-slate-100 text-xs rounded px-3 py-2 shadow-xl flex flex-col gap-1 min-w-[100px]"
                            style={{ 
                                left: tooltipPos.x + 15, 
                                top: tooltipPos.y - 15,
                            }}
                        >
                            <span className="font-bold border-b border-slate-700 pb-1 mb-1">{hoveredStat.date}</span>
                            <div className="flex justify-between">
                                <span className="text-green-400 font-bold">Vitórias:</span>
                                <span>{hoveredStat.wins}</span>
                            </div>
                            <div className="flex justify-between">
                                <span className="text-red-400 font-bold">Derrotas:</span>
                                <span>{hoveredStat.losses}</span>
                            </div>
                        </div>
                    )}

                    <div className="flex justify-between items-start mb-4">
                        <h4 className="text-slate-400 text-xs font-bold uppercase flex items-center gap-2">
                            <TrendingUp className="w-4 h-4 text-yellow-500"/> Desempenho (Dia)
                        </h4>
                    </div>
                    
                    <div 
                        ref={scrollRef}
                        className="overflow-x-auto pb-2 scrollbar-thin scrollbar-thumb-slate-700 scrollbar-track-slate-800/50"
                        onMouseMove={handleMouseMove}
                    >
                        <div className="flex items-end gap-3 h-48 px-2 min-w-max">
                            {statsByDate.map((stat, idx) => {
                                const winHeight = stat.wins > 0 ? Math.max((stat.wins / maxVal) * 100, 5) : 0;
                                const lossHeight = stat.losses > 0 ? Math.max((stat.losses / maxVal) * 100, 5) : 0;
                                
                                return (
                                    <div 
                                        key={idx} 
                                        className="flex flex-col items-center justify-end h-full w-12 min-w-[48px] group relative flex-shrink-0 cursor-default hover:bg-white/5 rounded transition-colors"
                                        onMouseEnter={() => setHoveredStat(stat)}
                                        onMouseLeave={() => setHoveredStat(null)}
                                    >
                                        <div className="w-full flex items-end justify-center gap-1 h-full px-1">
                                            <div className="flex-1 bg-slate-800/30 rounded-t-sm h-full flex items-end relative overflow-hidden">
                                                 <div 
                                                    style={{ height: `${winHeight}%` }} 
                                                    className={`w-full transition-all duration-300 ${
                                                        hoveredStat === stat ? 'bg-green-400' : 'bg-green-600'
                                                    }`}
                                                ></div>
                                            </div>

                                            <div className="flex-1 bg-slate-800/30 rounded-t-sm h-full flex items-end relative overflow-hidden">
                                                <div 
                                                    style={{ height: `${lossHeight}%` }} 
                                                    className={`w-full transition-all duration-300 ${
                                                        hoveredStat === stat ? 'bg-red-400' : 'bg-red-600'
                                                    }`}
                                                ></div>
                                            </div>
                                        </div>
                                        
                                        <span className={`text-[10px] mt-2 font-mono whitespace-nowrap transition-colors ${
                                            hoveredStat === stat ? 'text-white font-bold' : 'text-slate-500'
                                        }`}>{stat.date}</span>
                                    </div>
                                )
                            })}
                        </div>
                    </div>
                </div>
            );
        };

        const TournamentBracketModal = ({ tournament, onClose }) => {
            if (!tournament) return null;

            // Organizar partidas em "Rounds" (Chaves)
            // Assumindo que a ordem é cronológica inversa (última = final)
            const matches = [...tournament.matches].sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
            
            // Agrupamento heurístico simples:
            // Índice 0: Final
            // Índice 1-2: Semifinais
            // Índice 3-6: Quartas
            // Índice 7+: Classificatórias
            
            const rounds = {
                'Final': [matches[0]].filter(Boolean),
                'Semifinais': matches.slice(1, 3),
                'Quartas de Final': matches.slice(3, 7),
                'Classificatórias': matches.slice(7)
            };

            return (
                <div className="fixed inset-0 bg-black/90 backdrop-blur-sm flex justify-center items-center p-4 z-50">
                    <div className="bg-slate-900 w-full max-w-5xl rounded-2xl shadow-2xl border border-slate-700 overflow-hidden flex flex-col h-[90vh]">
                        <div className="p-6 border-b border-slate-700 flex justify-between items-center bg-slate-800/50">
                            <div>
                                <h2 className="text-2xl font-bold text-white flex items-center gap-3">
                                    <Trophy className="text-yellow-500 w-6 h-6" />
                                    {tournament.name}
                                </h2>
                                <p className="text-slate-400 text-sm mt-1">{tournament.date}</p>
                            </div>
                            <button onClick={onClose} className="p-2 hover:bg-slate-700 rounded-full transition-colors text-slate-400 hover:text-white">
                                <XIcon className="w-6 h-6" />
                            </button>
                        </div>

                        <div className="flex-1 overflow-y-auto p-6 scrollbar-thin bg-slate-950/50">
                            {Object.entries(rounds).map(([roundName, roundMatches]) => {
                                if (roundMatches.length === 0) return null;
                                return (
                                    <div key={roundName} className="mb-8 last:mb-0">
                                        <div className="flex items-center gap-4 mb-4">
                                            <div className="h-px bg-slate-700 flex-1"></div>
                                            <h3 className="text-yellow-500 font-bold uppercase tracking-widest text-sm">{roundName}</h3>
                                            <div className="h-px bg-slate-700 flex-1"></div>
                                        </div>
                                        
                                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-4">
                                            {roundMatches.map((match, idx) => (
                                                <div key={idx} className="bg-slate-900 border border-slate-800 rounded-lg p-4 flex flex-col items-center justify-center relative overflow-hidden group hover:border-slate-600 transition-colors">
                                                    {/* Vencedor */}
                                                    <div className="w-full flex justify-between items-center mb-2">
                                                        <span className="text-green-400 font-bold truncate flex-1">{match.winners.join(', ')}</span>
                                                        <Trophy className="w-4 h-4 text-yellow-500 ml-2" />
                                                    </div>
                                                    
                                                    <div className="w-full h-px bg-slate-800 my-1"></div>
                                                    
                                                    {/* Perdedor */}
                                                    <div className="w-full flex justify-between items-center mt-2 opacity-60">
                                                        <span className="text-red-400 font-medium truncate flex-1">{match.losers.join(', ')}</span>
                                                    </div>

                                                    <div className="absolute top-2 right-2 text-[10px] text-slate-600 bg-slate-950 px-1 rounded">
                                                        {new Date(match.timestamp).toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}
                                                    </div>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                );
                            })}
                        </div>
                    </div>
                </div>
            );
        };

        const PlayerModal = ({ player, history, onClose, activeTab }) => {
            if (!player) return null;

            const allMatches = history[player.name] || [];
            
            const playerMatches = useMemo(() => {
                if (activeTab === 'Geral') return allMatches;
                if (activeTab === 'Ranked') {
                    return allMatches.filter(match => ['Auto1v1', 'Auto2v2', 'Auto3v3'].includes(match.mode));
                }
                return allMatches.filter(match => match.mode === activeTab);
            }, [allMatches, activeTab]);

            const sortedMatches = [...playerMatches].sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));

            const matchesByDate = sortedMatches.reduce((groups, match) => {
                const date = match.timestamp 
                    ? new Date(match.timestamp).toLocaleDateString('pt-BR') 
                    : 'Data desconhecida';
                if (!groups[date]) {
                    groups[date] = [];
                }
                groups[date].push(match);
                return groups;
            }, {});

            return (
                <div className="fixed inset-0 bg-black/80 backdrop-blur-sm flex justify-center items-center p-4 z-50">
                    <div className="bg-slate-900 w-full max-w-6xl rounded-2xl shadow-2xl border border-slate-700 overflow-hidden flex flex-col h-[90vh]">
                        
                        <div className="p-6 border-b border-slate-700 flex justify-between items-start bg-slate-800/50 flex-shrink-0">
                            <div>
                                <h2 className="text-3xl font-bold text-white mb-1 flex items-center gap-2">
                                    {player.name}
                                    {parseFloat(player.winRate) >= 60 && <TrendingUp className="w-6 h-6 text-green-400" />}
                                </h2>
                                <div className="flex flex-wrap gap-4 text-sm text-slate-400 items-center">
                                    <span className="bg-slate-800 px-2 py-0.5 rounded border border-slate-700 text-xs text-yellow-500 font-bold uppercase tracking-wider">
                                        {activeTab}
                                    </span>
                                    <span>{player.wins} Vitórias</span>
                                    <span>{player.losses} Derrotas</span>
                                    <span className={parseFloat(player.winRate) >= 50 ? 'text-green-400' : 'text-red-400'}>
                                        {player.winRate}% WR
                                    </span>
                                </div>
                            </div>
                            <button onClick={onClose} className="text-slate-400 hover:text-white transition-colors p-2 hover:bg-slate-700 rounded-full">
                                <XIcon className="w-6 h-6" />
                            </button>
                        </div>

                        <div className="flex-1 overflow-hidden min-h-0">
                            <div className="h-full flex flex-col lg:flex-row-reverse">
                                <div className="w-full lg:w-[45%] p-4 lg:p-6 bg-slate-900 lg:border-l border-b lg:border-b-0 border-slate-800 overflow-y-auto lg:overflow-visible flex-shrink-0">
                                    <PlayerPerformanceChart matches={playerMatches} />
                                    <div className="bg-slate-950/30 p-4 rounded-xl border border-slate-800">
                                        <h4 className="text-slate-400 text-xs font-bold uppercase mb-3 flex items-center gap-2">
                                            <InfoIcon className="w-4 h-4 text-blue-500"/> Estatísticas Rápidas
                                        </h4>
                                        <div className="space-y-2 text-sm">
                                            <div className="flex justify-between text-slate-300">
                                                <span>Total Partidas</span>
                                                <span className="font-bold">{playerMatches.length}</span>
                                            </div>
                                            <div className="flex justify-between text-slate-300">
                                                <span>Taxa de Vitória</span>
                                                <span className={parseFloat(player.winRate) >= 50 ? 'text-green-400 font-bold' : 'text-red-400 font-bold'}>{player.winRate}%</span>
                                            </div>
                                            <div className="flex justify-between text-slate-300">
                                                <span>Melhor Modo</span>
                                                <span className="text-yellow-500 font-medium">
                                                    {Object.entries(player.modes).sort((a,b) => b[1].wins - a[1].wins)[0]?.[0] || '-'}
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div className="w-full lg:w-[55%] flex flex-col h-full bg-slate-950/20">
                                    <div className="p-4 lg:p-6 pb-2 border-b border-slate-800 bg-slate-900/50 backdrop-blur-sm z-20 flex-shrink-0">
                                        <h3 className="text-lg font-bold text-white flex items-center gap-2">
                                            <Clock className="w-5 h-5 text-slate-500"/> Histórico de Batalhas
                                        </h3>
                                    </div>

                                    <div className="flex-1 overflow-y-auto p-4 lg:p-6 pt-0 scrollbar-thin relative">
                                        {Object.keys(matchesByDate).length > 0 ? (
                                            Object.entries(matchesByDate).map(([date, matches]) => (
                                                <div key={date} className="mb-6 last:mb-0 relative">
                                                    <div className="bg-slate-900 border-b border-slate-800 py-2 mb-3 shadow-md">
                                                        <div className="flex items-center gap-2">
                                                            <Calendar className="w-4 h-4 text-yellow-500" />
                                                            <h4 className="text-slate-300 text-sm font-bold uppercase tracking-wider">{date}</h4>
                                                            <span className="text-xs text-slate-600 font-medium bg-slate-800 px-2 rounded-full border border-slate-700">{matches.length} partidas</span>
                                                        </div>
                                                    </div>
                                                    
                                                    <div className="space-y-2">
                                                        {matches.map((match, idx) => (
                                                            <div 
                                                                key={idx} 
                                                                className={`p-3 rounded-lg border flex flex-col sm:flex-row justify-between items-start sm:items-center gap-2 transition-all ${
                                                                    match.result === 'win' 
                                                                        ? 'bg-green-900/5 border-green-500/10 hover:bg-green-900/10' 
                                                                        : 'bg-red-900/5 border-red-500/10 hover:bg-red-900/10'
                                                                }`}
                                                            >
                                                                <div className="flex flex-col">
                                                                    <span className="text-[10px] font-bold uppercase tracking-wider text-slate-500 mb-0.5 flex items-center gap-1">
                                                                        {match.mode}
                                                                    </span>
                                                                    <div className="flex items-center gap-2 text-slate-200 text-sm font-medium">
                                                                        <span className={match.result === 'win' ? 'text-green-500 font-bold' : 'text-red-500 font-bold'}>
                                                                            {match.result === 'win' ? 'V' : 'D'}
                                                                        </span>
                                                                        <span className="text-slate-600">vs</span>
                                                                        <span>{match.opponent}</span>
                                                                    </div>
                                                                </div>
                                                                
                                                                <div className="text-right flex items-center gap-2 text-slate-500 text-xs">
                                                                    <span>
                                                                        {match.timestamp ? new Date(match.timestamp).toLocaleTimeString('pt-BR', {
                                                                            day: '2-digit',
                                                                            month: '2-digit',
                                                                            hour: '2-digit', 
                                                                            minute: '2-digit'
                                                                        }).replace(',', '') : '--:--'}
                                                                    </span>
                                                                </div>
                                                            </div>
                                                        ))}
                                                    </div>
                                                </div>
                                            ))
                                        ) : (
                                            <div className="text-center py-10 text-slate-500">
                                                Nenhuma partida registrada neste filtro.
                                            </div>
                                        )}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        const App = () => {
            const [rawData, setRawData] = useState([]);
            const [data, setData] = useState({ rankings: [], history: {} });
            const [isLoading, setIsLoading] = useState(true);
            const [error, setError] = useState(null);
            
            const [searchTerm, setSearchTerm] = useState('');
            const [sortConfig, setSortConfig] = useState({ key: 'wins', direction: 'desc' });
            const [activeTab, setActiveTab] = useState('Geral');
            const [selectedPlayer, setSelectedPlayer] = useState(null);
            
            const [timeFilter, setTimeFilter] = useState('current_month');
            const [availableMonths, setAvailableMonths] = useState([]);
            const [targetMonth, setTargetMonth] = useState('');
            const [dateRange, setDateRange] = useState({ start: null, end: null });
            
            const [showOtherModes, setShowOtherModes] = useState(false);
            
            // Estado para Torneios
            const [viewMode, setViewMode] = useState('ranking'); // 'ranking' | 'tournaments'
            const [selectedTournament, setSelectedTournament] = useState(null);

            useEffect(() => {
                const favicon = document.getElementById('dynamic-favicon');
                if (favicon && CUSTOM_ICON_URL) {
                    favicon.href = CUSTOM_ICON_URL;
                }
            }, []);

            useEffect(() => {
                const fetchData = async () => {
                    setIsLoading(true);
                    setError(null);
                    
                    const loadedData = [];
                    let page = 1;
                    let foundEnd = false;

                    try {
                        while (!foundEnd) {
                            const url = `./servidor_page_${page}.json`;
                            try {
                                const response = await fetch(url);
                                if (response.ok) {
                                    const json = await response.json();
                                    if (Array.isArray(json)) {
                                        loadedData.push(...json);
                                    }
                                    page++;
                                } else {
                                    foundEnd = true;
                                }
                            } catch (err) {
                                foundEnd = true;
                            }
                        }
                        setRawData(loadedData);
                    } catch (err) {
                        console.error("Fetch error:", err);
                        setError(`Erro ao carregar dados: ${err.message}`);
                        setRawData([]); 
                    } finally {
                        setIsLoading(false);
                    }
                };
                fetchData();
            }, []);

            useEffect(() => {
                if (rawData.length === 0) {
                    setData({ rankings: [], history: {} });
                    return;
                }

                const timestamps = rawData
                    .map(l => l.timestamp ? new Date(l.timestamp).getTime() : 0)
                    .filter(t => t > 0);
                
                if (timestamps.length > 0) {
                    const minTime = Math.min(...timestamps);
                    const maxTime = Math.max(...timestamps);
                    setDateRange({
                        start: new Date(minTime).toLocaleDateString('pt-BR'),
                        end: new Date(maxTime).toLocaleDateString('pt-BR')
                    });

                    const uniqueMonths = new Set();
                    timestamps.forEach(ts => {
                        const d = new Date(ts);
                        const key = `${d.getFullYear()}-${String(d.getMonth() + 1).padStart(2, '0')}`;
                        uniqueMonths.add(key);
                    });
                    const sortedMonths = Array.from(uniqueMonths).sort().reverse();
                    setAvailableMonths(sortedMonths);
                    
                    if (!targetMonth && sortedMonths.length > 0) {
                        setTargetMonth(sortedMonths[0]);
                    }
                }

                const referenceDate = new Date(); 

                const filteredLogs = rawData.filter(log => {
                    if (timeFilter === 'all') return true;
                    if (!log.timestamp) return false;
                    
                    const logTime = new Date(log.timestamp).getTime();
                    const logDate = new Date(log.timestamp);
                    
                    if (timeFilter === 'current_month') {
                        return logDate.getMonth() === referenceDate.getMonth() && 
                               logDate.getFullYear() === referenceDate.getFullYear();
                    }

                    if (timeFilter === 'specific_month') {
                        if (!targetMonth) return true;
                        const [year, month] = targetMonth.split('-').map(Number);
                        return logDate.getMonth() + 1 === month && 
                               logDate.getFullYear() === year;
                    }

                    const diff = referenceDate.getTime() - logTime;
                    const oneDay = 24 * 60 * 60 * 1000;
                    
                    if (timeFilter === 'day') return diff <= oneDay && diff >= 0;
                    if (timeFilter === 'week') return diff <= 7 * oneDay && diff >= 0;
                    return true;
                });

                const processed = processBattleLogs(filteredLogs);
                setData(processed);
            }, [rawData, timeFilter, targetMonth]);

            const modeGroups = useMemo(() => {
                if (rawData.length === 0) return { main: ['Geral', 'Ranked'], others: [] };
                const modes = new Set();
                rawData.forEach(log => {
                    const match = (log.content || "").match(/^\[(.*?)\]/);
                    if (match) modes.add(match[1]);
                });
                
                const allFoundModes = Array.from(modes);
                
                const mainModes = ['Geral', 'Ranked', ...PRIORITY_MODES.filter(m => modes.has(m))];
                const otherModes = allFoundModes.filter(m => !PRIORITY_MODES.includes(m)).sort();
                
                return { main: mainModes, others: otherModes };
            }, [rawData]);

            // Lógica de Agrupamento de Torneios
            const groupedTournaments = useMemo(() => {
                if (rawData.length === 0) return [];
                const groups = {};

                rawData.forEach(log => {
                    const content = log.content || "";
                    const match = content.match(/^\[(.*?)\] (.*?) derrotou (.*)/);
                    if (match && log.timestamp) {
                        const mode = match[1];
                        const date = new Date(log.timestamp).toLocaleDateString('pt-BR');
                        const key = `${mode}-${date}`;
                        
                        if (!groups[key]) {
                            groups[key] = {
                                id: key,
                                name: mode,
                                date: date,
                                timestamp: new Date(log.timestamp).getTime(),
                                matches: []
                            };
                        }
                        
                        const winners = match[2].split(',').map(n => n.trim()).filter(n => n.length > 0);
                        const losers = match[3].split(',').map(n => n.trim()).filter(n => n.length > 0);

                        groups[key].matches.push({
                            winners,
                            losers,
                            timestamp: log.timestamp
                        });
                    }
                });

                // Ordenar torneios por data (mais recente primeiro)
                return Object.values(groups).sort((a, b) => b.timestamp - a.timestamp);
            }, [rawData]);

            const filteredRankings = useMemo(() => {
                let players = [...data.rankings];

                if (activeTab === 'Geral') {
                } else if (activeTab === 'Ranked') {
                    players = players.map(p => {
                        let wins = 0, losses = 0, battles = 0;
                        const rankedModes = ['Auto1v1', 'Auto2v2', 'Auto3v3'];
                        
                        rankedModes.forEach(m => {
                            if (p.modes && p.modes[m]) {
                                wins += p.modes[m].wins;
                                losses += p.modes[m].losses;
                                battles += p.modes[m].battles;
                            }
                        });

                        if (battles === 0) return null;

                        return {
                            ...p,
                            wins,
                            losses,
                            battles,
                            winRate: ((wins / battles) * 100).toFixed(1)
                        };
                    }).filter(p => p !== null);
                } else {
                    players = players.map(p => {
                        const modeStats = p.modes && p.modes[activeTab];
                        if (!modeStats) return null;

                        return {
                            ...p,
                            wins: modeStats.wins,
                            losses: modeStats.losses,
                            battles: modeStats.battles,
                            winRate: modeStats.battles > 0 ? ((modeStats.wins / modeStats.battles) * 100).toFixed(1) : 0
                        };
                    }).filter(p => p !== null);
                }

                if (searchTerm) {
                    players = players.filter(p => p.name.toLowerCase().includes(searchTerm.toLowerCase()));
                }

                players.sort((a, b) => {
                    if (sortConfig.key === 'wins') {
                        if (a.wins !== b.wins) {
                            return sortConfig.direction === 'asc' ? a.wins - b.wins : b.wins - a.wins;
                        }
                        const wrA = parseFloat(a.winRate);
                        const wrB = parseFloat(b.winRate);
                        if (wrA !== wrB) {
                            return sortConfig.direction === 'asc' ? wrA - wrB : wrB - wrA;
                        }
                        return sortConfig.direction === 'asc' ? b.losses - a.losses : a.losses - b.losses;
                    }

                    let aValue = a[sortConfig.key];
                    let bValue = b[sortConfig.key];

                    if (!isNaN(parseFloat(aValue))) {
                        aValue = parseFloat(aValue);
                        bValue = parseFloat(bValue);
                    }

                    if (aValue < bValue) return sortConfig.direction === 'asc' ? -1 : 1;
                    if (aValue > bValue) return sortConfig.direction === 'asc' ? 1 : -1;
                    return 0;
                });

                return players;
            }, [data.rankings, searchTerm, sortConfig, activeTab]);

            const handleSort = (key) => {
                let direction = 'desc';
                if (sortConfig.key === key && sortConfig.direction === 'desc') {
                    direction = 'asc';
                }
                setSortConfig({ key, direction });
            };

            const totalBattles = filteredRankings.reduce((acc, curr) => acc + curr.wins, 0); 

            const mostWinsPlayer = useMemo(() => {
                if (filteredRankings.length === 0) return null;
                return [...filteredRankings].sort((a,b) => {
                    if (b.wins !== a.wins) return b.wins - a.wins;
                    return parseFloat(b.winRate) - parseFloat(a.winRate);
                })[0];
            }, [filteredRankings]);

            const mostLossesPlayer = useMemo(() => {
                if (filteredRankings.length === 0) return null;
                return [...filteredRankings].sort((a,b) => {
                    if (b.losses !== a.losses) return b.losses - a.losses;
                    return parseFloat(a.winRate) - parseFloat(b.winRate);
                })[0];
            }, [filteredRankings]);


            if (isLoading) {
                return (
                    <div className="min-h-screen bg-slate-950 flex flex-col items-center justify-center text-slate-400">
                        <Loader2 className="w-12 h-12 animate-spin text-yellow-500 mb-4" />
                        <p className="text-lg font-medium">Buscando dados do servidor...</p>
                        <p className="text-sm mt-2 text-slate-600">Procurando arquivos servidor_page_X.json...</p>
                    </div>
                );
            }

            if (error) {
                return (
                    <div className="min-h-screen bg-slate-950 flex flex-col items-center justify-center text-red-400 p-8 text-center">
                        <AlertCircle className="w-16 h-16 mb-4" />
                        <h2 className="text-2xl font-bold mb-2">Erro ao carregar dados</h2>
                        <p className="max-w-md">{error}</p>
                        <div className="mt-6 p-4 bg-slate-900 rounded border border-slate-800 text-left text-sm text-slate-400">
                            <p className="font-bold text-yellow-500 mb-2">Como corrigir:</p>
                            <ul className="list-disc pl-5 space-y-1">
                                <li>Certifique-se de que existe pelo menos o arquivo <code>servidor_page_1.json</code> na pasta correta.</li>
                                <li>Se estiver no GitHub, verifique se os arquivos JSON subiram corretamente.</li>
                            </ul>
                        </div>
                        <button 
                            onClick={() => window.location.reload()}
                            className="mt-6 px-6 py-2 bg-slate-800 rounded-lg hover:bg-slate-700 transition-colors text-white"
                        >
                            Tentar Novamente
                        </button>
                    </div>
                );
            }

            return (
                <div className="min-h-screen bg-slate-950 text-slate-100 font-sans p-4 md:p-8">
                    {/* Modais */}
                    {selectedPlayer && (
                        <PlayerModal 
                            player={selectedPlayer} 
                            history={data.history} 
                            activeTab={activeTab}
                            onClose={() => setSelectedPlayer(null)} 
                        />
                    )}
                    
                    {selectedTournament && (
                        <TournamentBracketModal
                            tournament={selectedTournament}
                            onClose={() => setSelectedTournament(null)}
                        />
                    )}

                    <div className="max-w-7xl mx-auto space-y-8 animate-in fade-in slide-in-from-bottom-8 duration-700">
                        
                        {/* Header Principal */}
                        <div className="flex flex-col lg:flex-row justify-between items-end border-b border-slate-800 pb-6 gap-6">
                            <div className="flex items-center gap-4 w-full lg:w-auto">
                                <img 
                                    src={CUSTOM_ICON_URL} 
                                    alt="Logo" 
                                    className="w-20 h-20 object-cover rounded-2xl shadow-lg shadow-orange-500/20"
                                    onError={(e) => {
                                        e.target.style.display = 'none';
                                        e.target.nextSibling.style.display = 'flex';
                                    }}
                                />
                                <div className="hidden bg-gradient-to-br from-yellow-500 to-orange-600 p-4 rounded-2xl shadow-lg shadow-orange-500/20 flex items-center justify-center w-20 h-20">
                                    <Trophy className="w-10 h-10 text-white" />
                                </div>
                                
                                <div className="flex flex-col gap-1">
                                    <h1 className="text-4xl font-black text-white tracking-tight">
                                        Nin Online <span className="text-transparent bg-clip-text bg-gradient-to-r from-yellow-400 to-orange-500">Tournaments</span>
                                    </h1>
                                    
                                    <div className="flex flex-wrap gap-2 mt-1">
                                        <div className="inline-flex items-center gap-1.5 px-3 py-1 bg-slate-800 rounded-full border border-slate-700 text-xs font-bold text-slate-300">
                                            <ServerIcon className="w-3 h-3 text-blue-400" />
                                            <span>Servidor: Hawk</span>
                                        </div>
                                        {dateRange.start && (
                                            <div className="inline-flex items-center gap-1.5 px-3 py-1 bg-slate-800 rounded-full border border-slate-700 text-xs font-bold text-slate-300">
                                                <Calendar className="w-3 h-3 text-yellow-500" />
                                                <span>{dateRange.start} até {dateRange.end}</span>
                                            </div>
                                        )}
                                    </div>
                                </div>
                            </div>

                            {/* Menu de Navegação Principal (Ranking / Torneios) */}
                            <div className="flex gap-2">
                                <button 
                                    onClick={() => setViewMode('ranking')}
                                    className={`px-4 py-2 rounded-lg font-bold text-sm transition-colors flex items-center gap-2 ${
                                        viewMode === 'ranking' ? 'bg-yellow-500 text-slate-900' : 'bg-slate-800 text-slate-400 hover:bg-slate-700 hover:text-white'
                                    }`}
                                >
                                    <Trophy className="w-4 h-4" /> Ranking
                                </button>
                                <button 
                                    onClick={() => setViewMode('tournaments')}
                                    className={`px-4 py-2 rounded-lg font-bold text-sm transition-colors flex items-center gap-2 ${
                                        viewMode === 'tournaments' ? 'bg-yellow-500 text-slate-900' : 'bg-slate-800 text-slate-400 hover:bg-slate-700 hover:text-white'
                                    }`}
                                >
                                    <GitBranch className="w-4 h-4" /> Torneios
                                </button>
                            </div>
                        </div>

                        {/* CONTEÚDO PRINCIPAL (ALTERNÁVEL) */}
                        {viewMode === 'ranking' ? (
                            <>
                                <div className="flex flex-col gap-4 w-full lg:w-auto items-end">
                                    <div className="flex flex-col sm:flex-row gap-4 w-full lg:w-auto">
                                        
                                        <div className="flex flex-row flex-wrap items-center gap-2">
                                            <div className="relative group w-full sm:w-48">
                                                <div className="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                                    <Calendar className="w-4 h-4 text-slate-500" />
                                                </div>
                                                <select 
                                                    value={timeFilter}
                                                    onChange={(e) => setTimeFilter(e.target.value)}
                                                    className="appearance-none w-full bg-slate-900 border border-slate-800 text-slate-200 rounded-xl py-3 pl-10 pr-10 focus:outline-none focus:ring-2 focus:ring-yellow-500/50 cursor-pointer hover:bg-slate-800 transition-colors"
                                                >
                                                    <option value="current_month">Este Mês</option>
                                                    <option value="day">Últimas 24h</option>
                                                    <option value="week">Última Semana</option>
                                                    <option value="specific_month">Selecionar Mês</option>
                                                    <option value="all">Todo o Período</option>
                                                </select>
                                                <div className="absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none">
                                                    <ChevronDown className="w-4 h-4 text-slate-500" />
                                                </div>
                                            </div>

                                            {timeFilter === 'specific_month' && availableMonths.length > 0 && (
                                                <div className="relative group w-full sm:w-48 animate-in fade-in slide-in-from-left-2 duration-200">
                                                    <select 
                                                        value={targetMonth}
                                                        onChange={(e) => setTargetMonth(e.target.value)}
                                                        className="appearance-none w-full bg-slate-800 border border-slate-700 text-slate-200 rounded-xl py-3 px-4 focus:outline-none focus:ring-2 focus:ring-blue-500/50 cursor-pointer text-sm"
                                                    >
                                                        {availableMonths.map(monthStr => {
                                                            const [year, month] = monthStr.split('-');
                                                            return (
                                                                <option key={monthStr} value={monthStr}>
                                                                    {`${month}/${year}`}
                                                                </option>
                                                            );
                                                        })}
                                                    </select>
                                                    <div className="absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none">
                                                        <ChevronDown className="w-3 h-3 text-slate-500" />
                                                    </div>
                                                </div>
                                            )}
                                        </div>

                                        <div className="relative w-full sm:w-64 group">
                                            <div className="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                                <Search className="w-5 h-5 text-slate-500 group-focus-within:text-yellow-500 transition-colors" />
                                            </div>
                                            <input 
                                                type="text" 
                                                placeholder="Buscar jogador..." 
                                                className="w-full bg-slate-900 border border-slate-800 text-slate-200 rounded-xl py-3 pl-10 pr-4 focus:outline-none focus:ring-2 focus:ring-yellow-500/50 focus:border-yellow-500 transition-all shadow-sm"
                                                value={searchTerm}
                                                onChange={(e) => setSearchTerm(e.target.value)}
                                            />
                                        </div>
                                    </div>
                                </div>

                                {/* Abas de Navegação (Modos) */}
                                <div className="flex flex-col gap-3 pb-2">
                                    <div className="flex flex-wrap gap-2">
                                        {modeGroups.main.map(mode => (
                                            <button
                                                key={mode}
                                                onClick={() => { setActiveTab(mode); setShowOtherModes(false); }}
                                                className={`px-5 py-2.5 rounded-xl text-sm font-bold whitespace-nowrap transition-all flex items-center gap-2 ${
                                                    activeTab === mode 
                                                        ? 'bg-yellow-500 text-slate-900 shadow-lg shadow-yellow-500/20' 
                                                        : 'bg-slate-800 text-slate-400 hover:bg-slate-700 hover:text-white'
                                                }`}
                                            >
                                                {mode === 'Geral' ? <Filter className="w-4 h-4" /> : 
                                                mode === 'Ranked' ? <ShieldCheck className="w-4 h-4" /> :
                                                <Swords className="w-4 h-4" />}
                                                {mode}
                                            </button>
                                        ))}

                                        {modeGroups.others.length > 0 && (
                                            <div className="relative">
                                                <button
                                                    onClick={() => setShowOtherModes(!showOtherModes)}
                                                    className={`px-5 py-2.5 rounded-xl text-sm font-bold whitespace-nowrap transition-all flex items-center gap-2 ${
                                                        modeGroups.others.includes(activeTab) 
                                                            ? 'bg-yellow-500 text-slate-900 shadow-lg shadow-yellow-500/20' 
                                                            : 'bg-slate-800 text-slate-400 hover:bg-slate-700 hover:text-white'
                                                    }`}
                                                >
                                                    <Menu className="w-4 h-4" />
                                                    {modeGroups.others.includes(activeTab) ? activeTab : "Outros Modos"}
                                                    <ChevronDown className={`w-4 h-4 transition-transform ${showOtherModes ? 'rotate-180' : ''}`} />
                                                </button>

                                                {showOtherModes && (
                                                    <div className="absolute top-full left-0 mt-2 w-48 bg-slate-900 border border-slate-800 rounded-xl shadow-xl z-20 overflow-hidden animate-in fade-in slide-in-from-top-2 duration-200">
                                                        {modeGroups.others.map(mode => (
                                                            <button
                                                                key={mode}
                                                                onClick={() => { setActiveTab(mode); setShowOtherModes(false); }}
                                                                className={`w-full text-left px-4 py-3 text-sm font-medium transition-colors hover:bg-slate-800 ${
                                                                    activeTab === mode ? 'text-yellow-500 bg-slate-800/50' : 'text-slate-400 hover:text-white'
                                                                }`}
                                                            >
                                                                {mode}
                                                            </button>
                                                        ))}
                                                    </div>
                                                )}
                                            </div>
                                        )}
                                    </div>
                                    
                                    <div className="text-slate-400 text-sm flex items-start gap-2 pl-1 animate-in fade-in duration-300">
                                        <InfoIcon className="w-4 h-4 mt-0.5 text-slate-500 flex-shrink-0" />
                                        <p>{MODE_DESCRIPTIONS[activeTab] || MODE_DESCRIPTIONS['Default']}</p>
                                    </div>
                                </div>

                                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                                    <Card title="Jogadores Ativos" value={filteredRankings.length} icon={Users} colorClass="text-blue-400 bg-blue-500" />
                                    <Card title="Batalhas Totais" value={totalBattles} icon={Swords} colorClass="text-red-400 bg-red-500" />
                                    <Card title="Mais Vitórias" value={mostWinsPlayer ? mostWinsPlayer.name : '-'} icon={Medal} colorClass="text-yellow-400 bg-yellow-500" />
                                    <Card title="Mais Derrotas" value={mostLossesPlayer ? mostLossesPlayer.name : '-'} icon={TrendingDown} colorClass="text-orange-400 bg-orange-500" />
                                </div>

                                <div className="bg-slate-900 rounded-2xl shadow-xl overflow-hidden border border-slate-800">
                                    <div className="overflow-x-auto">
                                        <table className="w-full text-left border-collapse">
                                            <thead>
                                                <tr className="bg-slate-950/50 border-b border-slate-800 text-slate-400 text-xs font-bold uppercase tracking-wider">
                                                    <th className="p-5 w-20 text-center">#</th>
                                                    <th className="p-5 cursor-pointer hover:text-white transition-colors" onClick={() => handleSort('name')}>Jogador</th>
                                                    <th className="p-5 text-center cursor-pointer hover:text-yellow-400 transition-colors" onClick={() => handleSort('wins')}>Vitórias</th>
                                                    <th className="p-5 text-center cursor-pointer hover:text-red-400 transition-colors" onClick={() => handleSort('losses')}>Derrotas</th>
                                                    <th className="p-5 text-center cursor-pointer hover:text-blue-400 transition-colors" onClick={() => handleSort('battles')}>Partidas</th>
                                                    <th className="p-5 text-center cursor-pointer hover:text-green-400 transition-colors" onClick={() => handleSort('winRate')}>Win Rate</th>
                                                </tr>
                                            </thead>
                                            <tbody className="divide-y divide-slate-800">
                                                {filteredRankings.map((player, index) => {
                                                    let rankColor = "text-slate-500";
                                                    let rankIcon = null;
                                                    const rank = index + 1;

                                                    if (rank === 1) { rankColor = "text-yellow-500"; rankIcon = <Trophy className="w-4 h-4 mx-auto" />; }
                                                    if (rank === 2) { rankColor = "text-slate-300"; rankIcon = <Medal className="w-4 h-4 mx-auto" />; }
                                                    if (rank === 3) { rankColor = "text-amber-700"; rankIcon = <Medal className="w-4 h-4 mx-auto" />; }

                                                    return (
                                                        <tr key={player.name} onClick={() => setSelectedPlayer(player)} className="hover:bg-slate-800/50 cursor-pointer transition-colors group">
                                                            <td className={`p-5 text-center font-bold ${rankColor} text-lg`}>{rankIcon || `#${rank}`}</td>
                                                            <td className="p-5 font-semibold text-white group-hover:text-yellow-400 transition-colors">{player.name}</td>
                                                            <td className="p-5 text-center font-bold text-slate-200">{player.wins}</td>
                                                            <td className="p-5 text-center font-medium text-slate-500">{player.losses}</td>
                                                            <td className="p-5 text-center text-slate-400">{player.battles}</td>
                                                            <td className="p-5 text-center">
                                                                <div className="flex flex-col items-center gap-1">
                                                                    <span className={`text-xs font-bold px-2 py-1 rounded-full ${
                                                                        parseFloat(player.winRate) >= 60 ? 'bg-green-500/20 text-green-400' : 
                                                                        parseFloat(player.winRate) >= 40 ? 'bg-yellow-500/20 text-yellow-400' : 
                                                                        'bg-red-500/20 text-red-400'
                                                                    }`}>{player.winRate}%</span>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                    );
                                                })}
                                                {filteredRankings.length === 0 && (
                                                    <tr>
                                                        <td colSpan="6" className="p-12 text-center text-slate-500">
                                                            <div className="flex flex-col items-center gap-3">
                                                                <Users className="w-12 h-12 text-slate-700" />
                                                                <p>Nenhum jogador encontrado para este filtro.</p>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                )}
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </>
                        ) : (
                            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 animate-in fade-in slide-in-from-bottom-4 duration-500">
                                {groupedTournaments.map(tournament => (
                                    <div 
                                        key={tournament.id}
                                        onClick={() => setSelectedTournament(tournament)}
                                        className="bg-slate-900 border border-slate-800 rounded-xl p-6 hover:bg-slate-800/80 hover:border-slate-600 transition-all cursor-pointer group shadow-lg"
                                    >
                                        <div className="flex items-center justify-between mb-4">
                                            <div className="bg-slate-800 p-3 rounded-full group-hover:bg-slate-700 transition-colors">
                                                <Trophy className="w-6 h-6 text-yellow-500" />
                                            </div>
                                            <span className="text-xs font-bold text-slate-500 bg-slate-950 px-2 py-1 rounded">{tournament.date}</span>
                                        </div>
                                        <h3 className="text-xl font-bold text-white mb-2 group-hover:text-yellow-400 transition-colors">{tournament.name}</h3>
                                        <div className="flex items-center gap-2 text-slate-400 text-sm">
                                            <Swords className="w-4 h-4" />
                                            <span>{tournament.matches.length} Partidas</span>
                                        </div>
                                    </div>
                                ))}
                                {groupedTournaments.length === 0 && (
                                    <div className="col-span-full text-center py-20 text-slate-500">
                                        <div className="flex flex-col items-center gap-4">
                                            <Trophy className="w-16 h-16 opacity-20" />
                                            <p className="text-lg">Nenhum torneio encontrado.</p>
                                        </div>
                                    </div>
                                )}
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
